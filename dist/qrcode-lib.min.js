var QRCodeLib=function(){"use strict";function a(a){this.__data=new Array,this.__bitsLeft=0}function b(a){var b,c,d,e;if(this.__data=null,this.__charCountBits=null,this.__mode=null,!this.__alphaNumSet){for(this.__alphaNumSet={},d=0;10>d;d++)this.__alphaNumSet[48+d]=d;for(d=10;36>d;d++)this.__alphaNumSet[55+d]=d;this.__alphaNumSet[32]=36,this.__alphaNumSet[36]=37,this.__alphaNumSet[37]=38,this.__alphaNumSet[42]=39,this.__alphaNumSet[43]=40,this.__alphaNumSet[45]=41,this.__alphaNumSet[46]=42,this.__alphaNumSet[47]=43,this.__alphaNumSet[58]=44}for(this.__mode=0,e=!1,d=0;d<a.length;d++){if(b=a.charCodeAt(d),b>255){this.__mode=2,e=!0;break}2!=this.__mode&&(0==this.__mode&&b>=48&&57>=b||(this.__mode=b in this.__alphaNumSet?1:2))}if(e)for(this.__data=[],c=null,d=0;d<a.length;d++)b=a.charCodeAt(d),null!=c?(b>=56320&&57344>b?(b=((1023&c)<<10|1023&b)+65536,this.__data.push(240|b>>18,128|b>>12&63,128|b>>6&63,128|63&b)):this.__data.push(239,191,189),c=null):128>b?this.__data.push(b):2048>b?this.__data.push(192|b>>6,128|63&b):55296>b||b>=57344?this.__data.push(224|b>>12,128|b>>6&63,128|63&b):56320>b?c=b:this.__data.push(239,191,189);else for(this.__data=Array(a.length),d=0;d<a.length;d++)this.__data[d]=a.charCodeAt(d);this.setVersion(1)}function c(a,b,c,d){var e,f;if(!a||!a.getContext)throw new Error("canvasElement should be the first parameter to QRCode");if(this.canvasElement=a,this.ctx=this.canvasElement.getContext("2d"),this.__ecLevel=0,this.__symbol=null,this.__symbolVersion=null,this.__symbolSize=null,this.__segments=new Array,b&&this.addSegment(b),d&&this.setECLevel(d),this.setScale(c||2),!this.__rs_exp_tbl){for(this.__rs_exp_tbl=new Array(512),this.__rs_log_tbl=new Array(256),this.__rs_exp_tbl[0]=1,this.__rs_log_tbl[1]=0,e=1,f=1;255>f;f++)e<<=1,256&e&&(e^=285),this.__rs_exp_tbl[f]=e,this.__rs_log_tbl[e]=f;for(f=255;512>f;f++)this.__rs_exp_tbl[f]=this.__rs_exp_tbl[f-255]}}return a.prototype.__masks=[0,1,3,7,15,31,63,127,255],a.prototype.append=function(a,b,c){var d,e;for(void 0==c&&(c=b),d=this.__data.length-1;b>0;)0==this.__bitsLeft&&(this.__data.push(0),this.__bitsLeft=8,d++),e=Math.min(b,this.__bitsLeft),this.__data[d]|=(a>>c-e&this.__masks[e])<<this.__bitsLeft-e,this.__bitsLeft-=e,b-=e,c-=e},a.prototype.getLength=function(){return 8*this.__data.length-this.__bitsLeft},a.prototype.getDataArray=function(){return this.__data},b.prototype.__alphaNumSet=null,b.prototype.__charCountBitsMap=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],b.prototype.setVersion=function(a){9>=a?this.__charCountBits=this.__charCountBitsMap[0][this.__mode]:26>=a?this.__charCountBits=this.__charCountBitsMap[1][this.__mode]:this.__charCountBits=this.__charCountBitsMap[2][this.__mode]},b.prototype.getBitStreamLength=function(){var a;if(0==this.__mode)switch(a=10*Math.floor(this.__data.length/3),this.__data.length%3){case 1:a+=4;break;case 2:a+=7}else 1==this.__mode?(a=11*(this.__data.length>>1),a+=6*(1&this.__data.length)):a=8*this.__data.length;return a+this.__charCountBits+4},b.prototype.encode=function(a){var b,c;switch(this.__mode){case 0:for(a.append(1,4),a.append(this.__data.length,this.__charCountBits),c=0,b=0;b<this.__data.length;b++)c=10*c+this.__data[b]-48,b%3==2&&(a.append(c,10),c=0);b%=3,0!=b&&a.append(c,1==b?4:7);break;case 1:for(a.append(2,4),a.append(this.__data.length,this.__charCountBits),c=0,b=0;b<this.__data.length;b++)c=45*c+this.__alphaNumSet[this.__data[b]],1&b&&(a.append(c,11),c=0);1&b&&a.append(c,6);break;case 2:for(a.append(4,4),a.append(this.__data.length,this.__charCountBits),b=0;b<this.__data.length;b++)a.append(this.__data[b],8)}},c.prototype.__rs_exp_tbl=null,c.prototype.__rs_log_tbl=null,c.prototype.__codeProps=[[[16,10,1],[28,16,1],[44,26,1],[64,18,2],[86,24,2],[108,16,4],[124,18,4],[154,22,4],[182,22,5],[216,26,5],[254,30,5],[290,22,8],[334,22,9],[365,24,9],[415,24,10],[453,28,10],[507,28,11],[563,26,13],[627,26,14],[669,26,16],[714,26,17],[782,28,17],[860,28,18],[914,28,20],[1e3,28,21],[1062,28,23],[1128,28,25],[1193,28,26],[1267,28,28],[1373,28,29],[1455,28,31],[1541,28,33],[1631,28,35],[1725,28,37],[1812,28,38],[1914,28,40],[1992,28,43],[2102,28,45],[2216,28,47],[2334,28,49]],[[19,7,1],[34,10,1],[55,15,1],[80,20,1],[108,26,1],[136,18,2],[156,20,2],[194,24,2],[232,30,2],[274,18,4],[324,20,4],[370,24,4],[428,26,4],[461,30,4],[523,22,6],[589,24,6],[647,28,6],[721,30,6],[795,28,7],[861,28,8],[932,28,8],[1006,28,9],[1094,30,9],[1174,30,10],[1276,26,12],[1370,28,12],[1468,30,12],[1531,30,13],[1631,30,14],[1735,30,15],[1843,30,16],[1955,30,17],[2071,30,18],[2191,30,19],[2306,30,19],[2434,30,20],[2566,30,21],[2702,30,22],[2812,30,24],[2956,30,25]],[[9,17,1],[16,28,1],[26,22,2],[36,16,4],[46,22,4],[60,28,4],[66,26,5],[86,26,6],[100,24,8],[122,28,8],[140,24,11],[158,28,11],[180,22,16],[197,24,16],[223,24,18],[253,30,16],[283,28,19],[313,28,21],[341,26,25],[385,28,25],[406,30,25],[442,24,34],[464,30,30],[514,30,32],[538,30,35],[596,30,37],[628,30,40],[661,30,42],[701,30,45],[745,30,48],[793,30,51],[845,30,54],[901,30,57],[961,30,60],[986,30,63],[1054,30,66],[1096,30,70],[1142,30,74],[1222,30,77],[1276,30,81]],[[13,13,1],[22,22,1],[34,18,2],[48,26,2],[62,18,4],[76,24,4],[88,18,6],[110,22,6],[132,20,8],[154,24,8],[180,28,8],[206,26,10],[244,24,12],[261,20,16],[295,30,12],[325,24,17],[367,28,16],[397,28,18],[445,26,21],[485,30,20],[512,28,23],[568,30,23],[614,30,25],[664,30,27],[718,30,29],[754,28,34],[808,30,34],[871,30,35],[911,30,38],[985,30,40],[1033,30,43],[1115,30,45],[1171,30,48],[1231,30,51],[1286,30,53],[1354,30,56],[1426,30,59],[1502,30,62],[1582,30,65],[1666,30,68]]],c.prototype.__alignPatternPositions=[[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],c.prototype.__maskFunctions=[function(a,b,c){return(b+c)%2?a:!a},function(a,b,c){return c%2?a:!a},function(a,b,c){return b%3?a:!a},function(a,b,c){return(b+c)%3?a:!a},function(a,b,c){return(Math.floor(c/2)+Math.floor(b/3))%2?a:!a},function(a,b,c){return b*c%2+b*c%3?a:!a},function(a,b,c){return(b*c%2+b*c%3)%2?a:!a},function(a,b,c){return((b+c)%2+b*c%3)%2?a:!a}],c.prototype.__penaltySequence=[1,0,1,1,1,0,1],c.prototype.addSegment=function(a){this.__segments.push(new b(a)),this.__symbol=null},c.prototype.clear=function(){this.__segments=new Array,this.__symbol=null},c.prototype.encode=function(a){this.clear(),this.addSegment(a),this.setCanvasSize(),this.draw(this.ctx)},c.prototype.setCanvasSize=function(){var a=this.getImageSize();this.canvasElement.width=this.canvasElement.height=a},c.prototype.setECLevel=function(a){switch(a){case"L":this.__ecLevel=1;break;case"M":this.__ecLevel=0;break;case"Q":this.__ecLevel=3;break;case"H":this.__ecLevel=2;break;default:throw new Error("Invalid error correction level value '"+a+"'. Valid values are 'L', 'M', 'Q' and 'H'.")}this.__symbol=null},c.prototype.getSymbolSize=function(){return this.__symbol||this.__encodeSymbol(),this.__symbolSize},c.prototype.getImageSize=function(a){return a=a||this.scale,a*(this.getSymbolSize()+8)},c.prototype.setScale=function(a){this.scale=a},c.prototype.draw=function(a,b){var c,d,e,f,g;for(void 0===b&&(b={}),b.scale=b.scale||this.scale,b.left=b.left||0,b.top=b.top||0,b.light=b.light||"#FFF",b.dark=b.dark||"#000",this.__symbol||this.__encodeSymbol(),d=this.getImageSize(b.scale),a.fillStyle=b.light,a.fillRect(b.left,b.top,d,d),a.fillStyle=b.dark,c=0,f=b.left+4*b.scale,g=b.top+4*b.scale,e=0;e<this.__symbolSize;e++)for(d=0;d<this.__symbolSize;d++)this.__symbol[c++]&&a.fillRect(f+d*b.scale,g+e*b.scale,b.scale,b.scale)},c.prototype.__encodeSymbol=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(e=1;40>=e;e++){for(f=0,b=0;b<this.__segments.length;b++)this.__segments[b].setVersion(e),f+=this.__segments[b].getBitStreamLength();if(i=8*this.__codeProps[this.__ecLevel][e-1][0],i>=f){j=this.__codeProps[this.__ecLevel][e-1][0],l=this.__codeProps[this.__ecLevel][e-1][1],m=this.__codeProps[this.__ecLevel][e-1][2];break}}if(e>40)throw new Error("The input data is too long to fit a single QR code symbol");for(this.__symbolVersion=e,this.__symbolSize=17+4*e,o=new a(i),b=0;b<this.__segments.length;b++)this.__segments[b].encode(o);for(o.getLength()+4<=i&&o.append(0,4),15&o.getLength()&&o.append(0,8-(15&o.getLength())),b=i-o.getLength();b>0;b-=16)o.append(60433,Math.min(b,16),16);for(r=Array(j+l*m),k=Math.floor(j/m),n=m-j%m,t=this.__rsCalculateGenerator(l),s=0,b=0;m>b;b++){for(q=n>b?0:1,p=this.__rsPolyMod(o.getDataArray().slice(s,s+k+q).concat(Array(l)),t),c=0;k>c;c++)r[b+c*m]=o.getDataArray()[s+c];for(q&&(r[b+c*m-n]=o.getDataArray()[s+c]),c=0;l>c;c++)r[j+b+c*m]=p[c];s+=k+q}for(g=-1,b=0;8>b;b++)h=this.__buildSymbol(r,b),c=this.__calculatePenaltyScore(h),(-1==g||g>c)&&(this.__symbol=h,d=b,g=c);this.__fillReservedAreas(this.__symbol,d)},c.prototype.__buildSymbol=function(a,b){var c,d,e,f,g,h,i,j,k;for(j=new Array(this.__symbolSize*this.__symbolSize),this.__createPattern(j,this.__finderPattern,0,0,7),this.__createPattern(j,this.__finderPattern,0,this.__symbolSize-7,7),this.__createPattern(j,this.__finderPattern,this.__symbolSize-7,0,7),c=0;8>c;c++)j[c+7*this.__symbolSize]=!1,j[7+c*this.__symbolSize]=!1,j[c+8*this.__symbolSize]=!1,j[8+c*this.__symbolSize]=!1,j[c+(this.__symbolSize-8)*this.__symbolSize]=!1,j[7+(this.__symbolSize-c-1)*this.__symbolSize]=!1,j[8+(this.__symbolSize-c-1)*this.__symbolSize]=!1,j[8*this.__symbolSize-c-1]=!1,j[(c+1)*this.__symbolSize-8]=!1,j[9*this.__symbolSize-c-1]=!1;if(this.__symbolVersion>=7)for(d=0;6>d;d++)for(c=this.__symbolSize-11;c<this.__symbolSize-8;c++)j[c+d*this.__symbolSize]=!1,j[c*this.__symbolSize+d]=!1;if(j[8+8*this.__symbolSize]=!1,j[8+(this.__symbolSize-8)*this.__symbolSize]=!0,this.__symbolVersion>=2)for(i=this.__alignPatternPositions[this.__symbolVersion-2],e=0;e<i.length;e++)for(f=0;f<i.length;f++)"undefined"==typeof j[i[f]*this.__symbolSize+i[e]]&&this.__createPattern(j,this.__alignmentPattern,i[e]-2,i[f]-2,5);for(c=8;c<this.__symbolSize-8;c++)j[6*this.__symbolSize+c]=0==(1&c),j[c*this.__symbolSize+6]=0==(1&c);for(k=this.__maskFunctions[b],g=128,e=f=this.__symbolSize-1,h=-1,c=0;;){if(d=e+f*this.__symbolSize,"undefined"==typeof j[d])if(j[d]=k(0!=(a[c]&g),e,f),g>1)g>>>=1;else{if(c++,c==a.length)break;g=128}if((1&e)==6>e?1:0)e--;else if(e++,f+=h,(0>f||f==this.__symbolSize)&&(h=-h,f+=h,e-=2-(6==e?1:0)),0>e)throw new Error("Internal error: too many data for a single QR code symbol.")}return j},c.prototype.__fillReservedAreas=function(a,b){var c,d,e;for(e=this.__ecLevel<<3|7&b,e=21522^this.__calculateSmallECCode(e,10,1335),c=0;8>c;c++)a[8+(c+(6>c?0:1))*this.__symbolSize]=0!=(1&e),a[8*this.__symbolSize+8-c-(2>c?0:1)]=0!=(128&e),c>0&&(a[8+(this.__symbolSize-8+c)*this.__symbolSize]=0!=(128&e)),a[9*this.__symbolSize-c-1]=0!=(1&e),e>>=1;if(this.__symbolVersion>=7)for(e=this.__calculateSmallECCode(this.__symbolVersion,12,7973),d=0;6>d;d++)for(c=this.__symbolSize-11;c<this.__symbolSize-8;c++)a[c+d*this.__symbolSize]=0!=(1&e),a[c*this.__symbolSize+d]=0!=(1&e),e>>=1},c.prototype.__finderPattern=function(a,b){return 0==a||6==a||0==b||6==b||1!=a&&5!=a&&1!=b&&5!=b},c.prototype.__alignmentPattern=function(a,b){return 0==a||4==a||0==b||4==b||2==a&&2==b},c.prototype.__createPattern=function(a,b,c,d,e){var f=d*this.__symbolSize+c;for(d=0;e>d;d++){for(c=0;e>c;c++)a[f++]=b(c,d);f+=this.__symbolSize-e}},c.prototype.__calculateSmallECCode=function(a,b,c){var d,e,f,g;for(d=a<<b,f=1<<b;d>=f;){for(e=c,g=f<<1;d>g;g<<=1)e<<=1;d^=e}return a<<b|d},c.prototype.__rsMul=function(a,b){return a&&b?this.__rs_exp_tbl[this.__rs_log_tbl[a]+this.__rs_log_tbl[b]]:0},c.prototype.__rsPolyMod=function(a,b){var c,d,e,f,g,h;for(c=a.slice(),h=b.length,g=a.length-h+1,e=0;g>e;e++)if(d=c[e])for(f=1;h>f;f++)c[e+f]^=this.__rsMul(b[f],d);return c.splice(-(h-1))},c.prototype.__rsCalculateGenerator=function(a){var b,c,d;for(b=Array(a+1),b[0]=1,c=0;a>c;c++)for(d=c;d>=0;d--)b[d+1]^=this.__rsMul(b[d],this.__rs_exp_tbl[c]);return b},c.prototype.__calculatePenaltyScore=function(a){var b,c,d,e,f,g,h,i,j;for(b=0,c=0;c<this.__symbolSize;c++){for(g=a[c*this.__symbolSize],f=(c+1)*this.__symbolSize,h=1,d=1+c*this.__symbolSize;f>d;d++)!g==!a[d]?h++:(h>=5&&(b+=h-2),h=1,g=a[d]);h>=5&&(b+=h-2)}for(f=this.__symbolSize*this.__symbolSize,c=0;c<this.__symbolSize;c++){for(g=a[c],h=1,d=c+this.__symbolSize;f>d;d+=this.__symbolSize)!g==!a[d]?h++:(h>=5&&(b+=h-2),h=1,g=a[d]);h>=5&&(b+=h-2)}for(d=1;d<this.__symbolSize;d++)for(c=1;c<this.__symbolSize;c++)h=c+d*this.__symbolSize,g=a[h],!g==!a[h-1]&&!g==!a[h-this.__symbolSize]&&!g==!a[h-this.__symbolSize-1]&&(b+=3);for(i=this.__penaltySequence,j=i.length,c=0;c<=this.__symbolSize-j;c++)for(d=0;d<this.__symbolSize;d++){for(h=c+d*this.__symbolSize,e=0;j>e&&!i[e]==!a[h+e];e++);for(e==j&&(!(c>=4)||a[h-1]||a[h-2]||a[h-3]||a[h-4]?c+j+4<this.__symbolSize&&(e=h+j,a[e]||a[e+1]||a[e+2]||a[e+3]||(b+=40)):b+=40),h=d+c*this.__symbolSize,e=0;j>e&&!i[e]==!a[h+e*this.__symbolSize];e++);e==j&&(!(c>=4)||a[h-this.__symbolSize]||a[h-2*this.__symbolSize]||a[h-3*this.__symbolSize]||a[h-4*this.__symbolSize]?c+j+4<this.__symbolSize&&(e=h+j*this.__symbolSize,a[e]||a[e+this.__symbolSize]||a[e+2*this.__symbolSize]||a[e+3*this.__symbolSize]||(b+=40)):b+=40)}for(h=0,j=this.__symbolSize*this.__symbolSize,c=0;j>c;c++)a[c]&&h++;return e=Math.floor(10*Math.abs(1-2*h/j)),b+=10*e},c}();